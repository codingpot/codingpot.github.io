<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Okteto에 gRPC용 Deployment, Service, Ingress 설정 | 코딩냄비 부글부글</title><meta name=description content="코딩냄비 프로젝트를 진행하며 배운것을 기록합니다."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Okteto에 gRPC용 Deployment, Service, Ingress 설정"><meta property="og:description" content="코딩냄비 프로젝트 중 pr12er는 TensorFlow Korea의 논문을 읽고/리뷰하는 모임 PR12에서 촬영된 동영상을 큐레이션하는 프로젝트입니다. 개략적으로 프론트엔드는 Flutter, 백엔드는 GO로 작성되었으며, 이 둘간의 인터페이스는 gRPC/protobuf로 구성되어있습니다. 특히 pr12er 프로젝트의 백엔드 서버는 PR이 Merge 됨과 동시에 Okteto가 제공하는k8s 에 배포되는 CD 루틴을 탑니다.
 이 글은 Okteto 에 배포하기위한 파이프라인을 분석하는 총 X 편의 시리즈물 중 두 번째입니다.
 Okteto 파이프라인 개요, okteto build, pr12er 서버용 Dockerfile 분석 Okteto에 gRPC용 Deployment, Service, Ingress 설정 &mldr;&mldr;&mldr;&mldr;&mldr;."><meta property="og:type" content="article"><meta property="og:url" content="https://codingpot.github.io/posts/2021-06-12-okteto-kubectl-apply/"><meta property="article:published_time" content="2021-06-11T00:00:00+00:00"><meta property="article:modified_time" content="2021-06-11T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Okteto에 gRPC용 Deployment, Service, Ingress 설정"><meta name=twitter:description content="코딩냄비 프로젝트 중 pr12er는 TensorFlow Korea의 논문을 읽고/리뷰하는 모임 PR12에서 촬영된 동영상을 큐레이션하는 프로젝트입니다. 개략적으로 프론트엔드는 Flutter, 백엔드는 GO로 작성되었으며, 이 둘간의 인터페이스는 gRPC/protobuf로 구성되어있습니다. 특히 pr12er 프로젝트의 백엔드 서버는 PR이 Merge 됨과 동시에 Okteto가 제공하는k8s 에 배포되는 CD 루틴을 탑니다.
 이 글은 Okteto 에 배포하기위한 파이프라인을 분석하는 총 X 편의 시리즈물 중 두 번째입니다.
 Okteto 파이프라인 개요, okteto build, pr12er 서버용 Dockerfile 분석 Okteto에 gRPC용 Deployment, Service, Ingress 설정 &mldr;&mldr;&mldr;&mldr;&mldr;."><link rel=stylesheet href=https://codingpot.github.io/css/style-white.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://codingpot.github.io/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://codingpot.github.io/intro/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://codingpot.github.io/posts/2021-06-11-okteto-pipeline-build/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');" aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&text=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&title=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&is_video=false&description=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95&body=Check out this article: https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&title=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&title=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&name=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95&description=%ec%bd%94%eb%94%a9%eb%83%84%eb%b9%84%20%ed%94%84%eb%a1%9c%ec%a0%9d%ed%8a%b8%20%ec%a4%91%20pr12er%eb%8a%94%20TensorFlow%20Korea%ec%9d%98%20%eb%85%bc%eb%ac%b8%ec%9d%84%20%ec%9d%bd%ea%b3%a0%2f%eb%a6%ac%eb%b7%b0%ed%95%98%eb%8a%94%20%eb%aa%a8%ec%9e%84%20PR12%ec%97%90%ec%84%9c%20%ec%b4%ac%ec%98%81%eb%90%9c%20%eb%8f%99%ec%98%81%ec%83%81%ec%9d%84%20%ed%81%90%eb%a0%88%ec%9d%b4%ec%85%98%ed%95%98%eb%8a%94%20%ed%94%84%eb%a1%9c%ec%a0%9d%ed%8a%b8%ec%9e%85%eb%8b%88%eb%8b%a4.%20%ea%b0%9c%eb%9e%b5%ec%a0%81%ec%9c%bc%eb%a1%9c%20%ed%94%84%eb%a1%a0%ed%8a%b8%ec%97%94%eb%93%9c%eb%8a%94%20Flutter%2c%20%eb%b0%b1%ec%97%94%eb%93%9c%eb%8a%94%20GO%eb%a1%9c%20%ec%9e%91%ec%84%b1%eb%90%98%ec%97%88%ec%9c%bc%eb%a9%b0%2c%20%ec%9d%b4%20%eb%91%98%ea%b0%84%ec%9d%98%20%ec%9d%b8%ed%84%b0%ed%8e%98%ec%9d%b4%ec%8a%a4%eb%8a%94%20gRPC%2fprotobuf%eb%a1%9c%20%ea%b5%ac%ec%84%b1%eb%90%98%ec%96%b4%ec%9e%88%ec%8a%b5%eb%8b%88%eb%8b%a4.%20%ed%8a%b9%ed%9e%88%20pr12er%20%ed%94%84%eb%a1%9c%ec%a0%9d%ed%8a%b8%ec%9d%98%20%eb%b0%b1%ec%97%94%eb%93%9c%20%ec%84%9c%eb%b2%84%eb%8a%94%20PR%ec%9d%b4%20Merge%20%eb%90%a8%ea%b3%bc%20%eb%8f%99%ec%8b%9c%ec%97%90%20Okteto%ea%b0%80%20%ec%a0%9c%ea%b3%b5%ed%95%98%eb%8a%94k8s%20%ec%97%90%20%eb%b0%b0%ed%8f%ac%eb%90%98%eb%8a%94%20CD%20%eb%a3%a8%ed%8b%b4%ec%9d%84%20%ed%83%91%eb%8b%88%eb%8b%a4.%0a%20%ec%9d%b4%20%ea%b8%80%ec%9d%80%20Okteto%20%ec%97%90%20%eb%b0%b0%ed%8f%ac%ed%95%98%ea%b8%b0%ec%9c%84%ed%95%9c%20%ed%8c%8c%ec%9d%b4%ed%94%84%eb%9d%bc%ec%9d%b8%ec%9d%84%20%eb%b6%84%ec%84%9d%ed%95%98%eb%8a%94%20%ec%b4%9d%20X%20%ed%8e%b8%ec%9d%98%20%ec%8b%9c%eb%a6%ac%ec%a6%88%eb%ac%bc%20%ec%a4%91%20%eb%91%90%20%eb%b2%88%ec%a7%b8%ec%9e%85%eb%8b%88%eb%8b%a4.%0a%20Okteto%20%ed%8c%8c%ec%9d%b4%ed%94%84%eb%9d%bc%ec%9d%b8%20%ea%b0%9c%ec%9a%94%2c%20okteto%20build%2c%20pr12er%20%ec%84%9c%eb%b2%84%ec%9a%a9%20Dockerfile%20%eb%b6%84%ec%84%9d%20Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95%20%26hellip%3b%26hellip%3b%26hellip%3b%26hellip%3b%26hellip%3b." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&t=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#어떤-yaml-파일들이-존재하나>어떤 <strong>yaml</strong> 파일들이 존재하나?</a></li><li><a href=#ingress>Ingress</a><ul><li><a href=#ingress-annotations>Ingress Annotations</a></li><li><a href=#ingress-spec>Ingress Spec</a></li></ul></li><li><a href=#service>Service</a><ul><li><a href=#service-metadata>Service Metadata</a></li><li><a href=#service-spec>Service Spec</a></li></ul></li><li><a href=#deployment>Deployment</a><ul><li><a href=#deployment-metadata>Deployment Metadata</a></li><li><a href=#deployment-spec>Deployment Spec</a></li><li><a href=#deployment-template-spec-1>Deployment Template Spec (1)</a></li><li><a href=#deployment-template-spec-2>Deployment Template Spec (2)</a></li><li><a href=#deployment-template-spec-3>Deployment Template Spec (3)</a></li></ul></li><li><a href=#마치며>마치며</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Okteto에 gRPC용 Deployment, Service, Ingress 설정</h1><div class=meta><div class=postdate><time datetime="2021-06-11 00:00:00 +0000 UTC" itemprop=datePublished>2021-06-11</time></div><div class=article-tag><i class="fas fa-tag"></i><a class=tag-link href=/tags/okteto rel=tag>okteto</a>
,
<a class=tag-link href=/tags/kubectl rel=tag>kubectl</a></div></div></header><div class=content itemprop=articleBody><blockquote><p>코딩냄비 프로젝트 중 <strong>pr12er</strong>는 TensorFlow Korea의 논문을 읽고/리뷰하는 모임 PR12에서 촬영된 동영상을 큐레이션하는 프로젝트입니다. 개략적으로 프론트엔드는 <strong>Flutter</strong>, 백엔드는 <strong>GO</strong>로 작성되었으며, 이 둘간의 인터페이스는 <strong>gRPC/protobuf</strong>로 구성되어있습니다. 특히 <strong>pr12er</strong> 프로젝트의 백엔드 서버는 <strong>PR</strong>이 <strong>Merge</strong> 됨과 동시에 <strong>Okteto</strong>가 제공하는<strong>k8s</strong> 에 배포되는 <strong>CD</strong> 루틴을 탑니다.</p></blockquote><p>이 글은 <strong>Okteto</strong> 에 배포하기위한 파이프라인을 분석하는 총 X 편의 시리즈물 중 두 번째입니다.</p><ol><li><a href=https://codingpot.github.io/cicd/okteto-pipeline-build/><strong>Okteto</strong> 파이프라인 개요, <strong>okteto build</strong>, <strong>pr12er</strong> 서버용 <strong>Dockerfile</strong> 분석</a></li><li><a href=https://codingpot.github.io/cicd/okteto-kubectl-apply/><strong>Okteto</strong>에 gRPC용 <strong>Deployment</strong>, <strong><strong>Service</strong></strong>, <strong>Ingress</strong> 설정</a></li><li>&mldr;&mldr;&mldr;&mldr;&mldr;.</li></ol><h1 id=pr12er에-적용된-okteto-파이프라인-명세서><strong>pr12er</strong>에 적용된 <strong>Okteto</strong> 파이프라인 명세서</h1><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#5bc4bf>deploy</span>:
<span style=color:#776e71>#  - okteto build -t okteto.dev/codingpot-pr12er-server:${OKTETO_GIT_COMMIT} -f ./server/deploy/Dockerfile server</span>
  - <span style=color:#f99b15>for file in k8s/kkweon-okteto/*.yaml; do envsubst &lt; $file | kubectl apply -f -; done</span>
<span style=color:#776e71>#  - kubectl set image deployment server server=okteto.dev/codingpot-pr12er-server:${OKTETO_GIT_COMMIT}</span>
<span style=color:#776e71>#  - kubectl rollout restart deployment grafana-agent</span>
<span style=color:#776e71>#  - kubectl rollout status deployment server &amp;&amp; kubectl rollout status deployment grafana-agent</span>
</code></pre></td></tr></table></div></div><h2 id=어떤-yaml-파일들이-존재하나>어떤 <strong>yaml</strong> 파일들이 존재하나?</h2><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>k8s/kkweon-okteto/
├── ingress.yaml
└── server.yaml
</code></pre></td></tr></table></div></div><p>현재 <strong>/k8s/kkweon-okteto/</strong> 디렉터리 내부에는 보다 다양한 <strong>yaml</strong> 파일들이 존재하지만, <strong>gRPC</strong> 서버를 운용하기위한 최소한의 조건은 k8s의 <strong>Deployment</strong>, <strong><strong>Service</strong></strong>, <strong>Ingress</strong> 객체를 정의해둔 <strong>ingress.yaml</strong> 및 <strong>server.yaml</strong> 두 파일만 참조하면 기본은 이해할 수 있습니다. 우선 각 파일의 세부 사항과 서로 엮인 관계를 분석해보죠.</p><p><img src=./images/ingress-service-deployment.png alt></p><h2 id=ingress>Ingress</h2><ul><li>서버 애플리케이션이 위치한 쿠버네티스 플랫폼은 외부로부터 차단된 고유한 영역을 가집니다. 하지만 사용자는 쿠버네티스 플랫폼 외부에 존재하는것이 보통이며, 이들은 쿠버네티스 자원으로 구축된 서버에 접근할 필요가 있습니다. <strong>Ingress</strong>는 쿠버네티스 외부와 내부를 엮어주는 일종의 브릿지 역할을 하는 객체입니다.</li></ul><h3 id=ingress-annotations>Ingress Annotations</h3><p><a href=dev.okteto.com/generate-host><strong>dev.okteto.com/generate-host: &ldquo;true&rdquo;</strong></a></p><ul><li><strong>Okteto</strong> 에서 자동으로 호스트 이름을 할당하는것을 허용하고자 할 때 사용되는 애노테이션입니다. <strong>Okteto</strong> <strong>Service</strong>를 활용한다면 거의 반드시 설정해줘야 하므로, <strong>true</strong>로 설정하였습니다.</li></ul><p><a href=https://www.nginx.com/resources/glossary/kubernetes-ingress-controller/><strong>kubernetes.io/ingress.class: &ldquo;nginx&rdquo;</strong></a></p><ul><li>쿠버네티스의 Ingress 컨트롤러를 nginx로 지정한다는 의미입니다.</li><li>Ingress 컨트롤러의 역할에는 외부 트래픽을 수용하여 내부 Pod 들로 로드밸런싱하기, 클러스터 밖의 다른 <strong>Service</strong>와 소통이 필요한 트래픽 관리, Pods들을 모니터링하여 추가/제거에 따른 로드밸런싱 규칙 갱신 등이 있습니다.</li><li>쿠버네티스가 공식적으로 지원하는 Ingress 컨트롤러로는 <strong>AWS</strong>, <strong>GCE</strong>, <strong>nginx</strong>가 있으며, 그 외의 써드파티에서 나온 Ingress 컨트롤러도 종류가 다양하니 요구사항에 맞는것을 찾아서 사용하면 됩니다 <a href=https://kubernetes.io/docs/concepts/**Service**s-networking/ingress-controllers/>(목록)</a>.</li></ul><p><a href=https://kubernetes.github.io/ingress-nginx/examples/grpc/#grpc><strong>nginx.ingress.kubernetes.io/backend-protocol: &ldquo;GRPC&rdquo;</strong></a></p><blockquote><p>This is the magic ingredient that sets up the appropriate nginx configuration to route http/2 traffic to our <strong>Service</strong>.</p></blockquote><ul><li>위는 공식문서의 설명입니다. 즉 nginx의 설정을 건드려서, <strong>HTTP/2</strong> 트래픽이 쿠버네티스 내부 <strong>Service</strong>로 들어올 수 있도록 해줍니다. gRPC를 사용하려면 <strong>HTTP/2</strong> 프로토콜이 반드시 필요하므로, 이 설정을 반드시 해줘야 합니다.</li></ul><p><a href=https://kubernetes.github.io/ingress-nginx/examples/rewrite/><strong>nginx.ingress.kubernetes.io/ssl-redirect: &ldquo;true&rdquo;</strong></a></p><blockquote><p>Indicates if the location section is accessible SSL only (defaults to True when Ingress contains a Certificate)</p></blockquote><ul><li>위는 공식문서의 설명입니다. SSL로만 접근 가능함을 명시합니다(디폴트는 <strong>true</strong> 인데, 여기서는 명시적으로 <strong>true</strong> 라고 적어줌). gRPC를 사용하려면 SSL이 반드시 필요하므로, 이 설정 또한 반드시 해줘야 합니다.</li></ul><h3 id=ingress-spec>Ingress Spec</h3><p><strong>Ingress</strong> 스펙은 일련의 규칙을 정의합니다. 특히 <strong>backend</strong> 라는 필드와, 그 이전까지의 부분들로 나누어 생각할 수 있습니다. <strong>backend</strong>는 말 그대로 <strong>Ingress</strong>를 통해 도달한 트래픽이 도달해야 할 쿠버네티스 내부의 위치를 의미합니다. 따라서 <strong>backend</strong>는 쿠버네티스 내부에서 목적지를 찾아가기 위한 규칙을 정의하는 필드이며, <strong>backend</strong> 이전까지의 필드들은 수용할 외부 트래픽의 형식을 판단하는 규칙을 정의합니다.</p><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#5bc4bf>spec</span>:
  <span style=color:#5bc4bf>rules</span>:
    - <span style=color:#5bc4bf>host</span>: <span style=color:#f99b15>this-name-does-not-matter</span>
      <span style=color:#5bc4bf>http</span>:
        <span style=color:#5bc4bf>paths</span>:
          - <span style=color:#5bc4bf>path</span>: <span style=color:#f99b15>/</span>
            <span style=color:#5bc4bf>pathType</span>: <span style=color:#f99b15>Prefix</span>
            <span style=color:#5bc4bf>backend</span>:
              <span style=color:#5bc4bf>service</span>:
                <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>server</span>
                <span style=color:#5bc4bf>port</span>:
                  <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>grpc</span>
</code></pre></td></tr></table></div></div><p><strong>pr12er</strong> 프로젝트에서 정의한 <strong>Ingress</strong> 스펙(규칙)을 살펴보죠.</p><ol><li><strong>rules</strong>에는 규칙 목록을 나열합니다.</li><li>가장 먼저 <strong>host</strong> 이름을 정의합니다. 이곳에는 보통 호스트명이 오지만, <strong>Okteto</strong>의 <strong><strong>dev.okteto.com/generate-host: &ldquo;true&rdquo;</strong></strong> 애노테이션을 사용했기 때문에, <strong>Okteto</strong>가 내부적으로 할당합니다. 따라서 무슨 값이든 상관 없습니다.</li><li>그 다음 경로를 지정합니다. <strong>path: /</strong> 와 <strong>pathType: Prefix</strong> 가 함께 쓰이면, 모든 경로의 트래픽을 수용합니다 <a href=https://kubernetes.io/docs/concepts/**Service**s-networking/ingress/#path-types>(참고자료)</a>.</li><li>이제 <strong>backend</strong>가 등장합니다. 즉 <strong>Okteto</strong>가 내부적으로 할당한 호스트명에 대해 모든 경로로 접근하는 트래픽은 <strong>backend</strong>에서 정의된 내부 목적지로 포워딩 되는것이죠.</li><li><strong>service.name: server</strong>는 들어온 외부 트래픽이 도달할 <strong>Service</strong> 이름입니다. 여기서는 <strong>server</strong> 이므로, 이 <strong>Ingress</strong>를 거쳐 들어온 외부 트래픽이 포워딩될 목적지를 파악하려면 <strong>server</strong> 라는 이름을 가진 <strong>Service</strong>를 찾아봐야 한다고 해석될 수 있습니다. <strong>Service</strong>에 대한 부분은 잠시 후 아래에서 확인하겠습니다.</li><li><strong>service.port.name: grpc</strong>는 들어온 외부 트래픽이 내부에서 전달될 포트명을 명시합니다. **<strong>service</strong>.port.number**로 직접 포트 번호를 명시할 수도 있지만, <strong>service.port.name</strong>을 활용하면 특정 프로토콜에 이미 예약된 포트번호를 할당하는것도 가능합니다. 여기서는 <strong>grpc</strong>로 명시합니다.</li></ol><h2 id=service>Service</h2><p><strong>Service</strong>는 쿠버내티스 내부에서 트래픽을 원하는 목적지 <strong>Pod</strong>으로 포워딩하는 역할을 하는 객체입니다. <strong>Ingress</strong>가 외부 트래픽을 여러 <strong>Service</strong>로 연결시키는것이 목적이었다면, <strong>Service</strong>는 특정 그룹의 <strong>Pod</strong>들에 대해 트래픽을 연결시켜주는 셈이죠.</p><p>또한 <strong>Service</strong>는 쿠버네티스 내부의 <strong>Pod</strong> 들간의 연결 창구가 되기도 합니다. 나중에 보게 되겠지만, 자원 모니터링을하는 도구인 그라파나 에이전트는 서버로부터 모니터링 할 내용을 폴링/조회 하기위해 <strong>Service</strong>에 정의된 <strong>http-metrics</strong> 라는 이름의 <strong>9093</strong> 포트를 탑니다.</p><h3 id=service-metadata>Service Metadata</h3><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#5bc4bf>metadata</span>:
  <span style=color:#5bc4bf>labels</span>:
    <span style=color:#5bc4bf>app</span>: <span style=color:#f99b15>server</span>
  <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>server</span>
</code></pre></td></tr></table></div></div><p><strong>Service</strong> 메타데이터에는 <strong>Service</strong> 객체를 구분할 수 있는 식별자를 기입합니다. 특히 <strong>metadata.name</strong>에 적힌 이름이 바로 <strong>Ingress</strong>의 <strong>backend.service.name</strong>과 매칭이 되어야만, 해당 <strong>Ingress</strong>를 통해 들어온 외부 트래픽이 해당 <strong>Service</strong>로 연결될 수 있습니다. <strong>pr12er</strong> 프로젝트에서는 <strong>server</strong> 라는 이름을 할당했습니다.</p><h3 id=service-spec>Service Spec</h3><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#5bc4bf>spec</span>:
  <span style=color:#5bc4bf>selector</span>:
    <span style=color:#5bc4bf>app</span>: <span style=color:#f99b15>server</span>
  <span style=color:#5bc4bf>ports</span>:
    - <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>grpc</span>
      <span style=color:#5bc4bf>port</span>: <span style=color:#f99b15>9000</span>
      <span style=color:#5bc4bf>protocol</span>: <span style=color:#f99b15>TCP</span>
      <span style=color:#5bc4bf>targetPort</span>: <span style=color:#f99b15>grpc</span>
    - <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>http-metrics</span>
      <span style=color:#5bc4bf>port</span>: <span style=color:#f99b15>9093</span>
      <span style=color:#5bc4bf>protocol</span>: <span style=color:#f99b15>TCP</span>
      <span style=color:#5bc4bf>targetPort</span>: <span style=color:#f99b15>http-metrics</span>
</code></pre></td></tr></table></div></div><p><strong>Service</strong> 또한 <strong>Ingress</strong> 처럼 인터페이스를 위한 객체이므로, <strong>Service</strong>를 통해서 연결될 애플리케이션이 탑재된 <strong>Pod</strong>을 지정(매핑), 프로토콜, 포트정보와 같은것들이 명시되어야 합니다.</p><p><strong>selector.app</strong>은 <strong>Service</strong>를 통해서 연결될 <strong>Deployment</strong>를 지정합니다. 아래에서 나오겠지만, <strong>Deployment</strong> 객체에 명시된 <strong>metadata.labels.app</strong>와 <strong>Service</strong>의 <strong>selector.app</strong>이 서로 매핑되어 있습니다. 그리고 <strong>ports</strong>는 <strong>Service</strong>가 연결을 허용하는 창구의 목록입니다.</p><p>각 창구마다 포트의 종류가 <strong>port</strong> 및 <strong>targetPort</strong> 두 개가 존재하는데, <strong>port</strong>는 클러스터내 애플리케이션에 대해서 노출되는 포트이며, <strong>targetPort</strong>는 <strong>Service</strong>로 도착한 트래픽이 포워딩될 <strong>Pod</strong>의 포트입니다. 여기에 더해서 <strong>NodePort</strong>를 추가적으로 정의할 수 있으며, 이것의 역할은 클러스터간의 통신에 사용 가능한 포트를 정의하는 것입니다.</p><p><strong>pr12er</strong> 프로젝트에서 정의한 <strong>Service</strong> 스펙을 살펴보죠.</p><ol><li><strong>Ingress</strong>를 통해 들어온 트래픽은 <strong>server</strong>라는 이름을 가진 <strong>Service</strong>로 포워딩됩니다.</li><li><strong>server</strong> 라는 이름의 <strong>Service</strong>는 두 개의 인터페이스를 외부로 노출시키는 역할을 합니다.</li><li><strong>grpc</strong> 인터페이스에는 <strong>TCP</strong> 프로토콜이 사용되며, 해당 <strong>Service</strong>로 들어온 트래픽은 <strong>targetPort:grpc</strong> 포트로 포워딩됩니다.<ul><li><strong>port: 9000</strong>은 클러스터 내부의 <strong>Pod</strong>간 통신을 위한 인터페이스입니다.</li></ul></li><li><strong>http-metrics</strong> 인터페이스에도 <strong>TCP</strong> 프로토콜이 사용되며, 해당 <strong>Service</strong>로 들어온 트래픽은 <strong>targetPort:http-metrics</strong> 포트로 포워딩됩니다.<ul><li><strong>port:9093</strong>은 클러스 내부의 <strong>Pod</strong>간 통신을 위한 인터페이스입니다. 같은 클러스터 내부에 그라파나 에이전트용 애플리케이션이 실행되고 있으며, 해당 애플리케이션은 이 포트를 통해 <strong>pr12er</strong> 서버로부터 모니터링 정보를 긁어가게 됩니다.</li></ul></li></ol><h2 id=deployment>Deployment</h2><p><strong>Deployment</strong>는 원하는 배포 상태가 명시된 객체로, <strong>Pod</strong>과 <strong>ReplicaSet</strong>을 함께 사용하여 해당 상태를 정의합니다. <strong>Pod</strong>은 배포하고자 하는 컨테이너에 대한 명세서, <strong>ReplicaSet</strong>은 배포될 <strong>Pod</strong>을 항상 몇 개나 유지할지를 정의한 명세서로 볼 수 있습니다.</p><h3 id=deployment-metadata>Deployment Metadata</h3><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#5bc4bf>metadata</span>:
  <span style=color:#5bc4bf>labels</span>:
    <span style=color:#5bc4bf>app</span>: <span style=color:#f99b15>server</span>
  <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>server</span>
</code></pre></td></tr></table></div></div><p><strong>Deployment</strong> 의 메타데이터도 단순합니다. 단지 해당 <strong>Deployment</strong>를 식별할 수 있는 정보가 기입되며, 이 식별 정보는 다른 쿠버네티스 객체가 참조용으로 사용합니다. 가령 상기 <strong>metadata.labels.app</strong>에 들어간 <strong>server</strong>라는 식별자는 <strong>Service</strong> 객체가 트래픽을 포워딩 할 대상체를 특정하는데 활용됩니다.</p><h3 id=deployment-spec>Deployment Spec</h3><p><strong>Deployment Spect</strong>은 내용이 길기 때문에 네 개의 파트로 나누어 설명하겠습니다.</p><p>우선 <strong>spec.replicas</strong>는 <strong>Deployment</strong> 에서 유지되어야 할 <strong>Pod</strong>의 개수를 명시합니다.</p><p>그리고 꽤 친숙한 <strong>spec.selector</strong> 라는 필드가 등장합니다. 여기서의 <strong>spec.selector</strong>의 역할은 <strong>Deployment</strong>에서 정의된 <strong>spec.replicas</strong> 라는 규칙이 적용될 <strong>Pod</strong>의 식별자를 찾는것입니다.</p><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#5bc4bf>spec</span>:
  <span style=color:#5bc4bf>replicas</span>: <span style=color:#f99b15>1</span>
  <span style=color:#5bc4bf>selector</span>:
    <span style=color:#5bc4bf>matchLabels</span>:
      <span style=color:#5bc4bf>app</span>: <span style=color:#f99b15>server</span>
  <span style=color:#5bc4bf>template</span>:
    <span style=color:#5bc4bf>metadata</span>:
      <span style=color:#5bc4bf>labels</span>:
        <span style=color:#5bc4bf>app</span>: <span style=color:#f99b15>server</span>
</code></pre></td></tr></table></div></div><p>그 다음으로 나타나는 <strong>spec.template</strong>이 바로 <strong>Pod</strong>의 상세한 스펙을 명시하는 필드입니다. 우선 <strong>template.metadata.labels</strong> 은 <strong>Pod</strong>을 식별하기 위한 메타데이터를 명시한 것으로, 직전 <strong>spec.selector.matchLabels</strong>의 값과 일치하는 경우 앞서 정의한 <strong>ReplicaSet</strong> 규칙이 해당 <strong>Pod</strong>에 적용됩니다.</p><h3 id=deployment-template-spec-1>Deployment Template Spec (1)</h3><p>이제 <strong>Pod</strong>의 스펙을 살펴볼 차례입니다. <strong>template.spec.containers</strong>에는 <strong>Pod</strong>에서 구동될 컨테이너 목록에 대한 상세한 스펙을 기술합니다. <strong>containers.image</strong>는 실행될 도커 이미지, <strong>containers.imagePullPolicy</strong>는 도커 이미지를 내려받을 정책, <strong>containers.ports</strong>는 컨테이너가 노출할 포트 정보를 담습니다.</p><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#5bc4bf>spec</span>:
  <span style=color:#5bc4bf>replicas</span>: <span style=color:#f99b15>1</span>
  <span style=color:#5bc4bf>selector</span>:
    <span style=color:#776e71># ommited</span>
  <span style=color:#5bc4bf>template</span>:
    <span style=color:#776e71># ommited</span>
    <span style=color:#5bc4bf>spec</span>:
      <span style=color:#5bc4bf>containers</span>:
        - <span style=color:#5bc4bf>image</span>: <span style=color:#f99b15>okteto.dev/codingpot-pr12er-server</span>
          <span style=color:#5bc4bf>imagePullPolicy</span>: <span style=color:#f99b15>IfNotPresent</span>
          <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>server</span>
          <span style=color:#5bc4bf>ports</span>:
            - <span style=color:#5bc4bf>containerPort</span>: <span style=color:#f99b15>9000</span>
              <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>grpc</span>
              <span style=color:#5bc4bf>protocol</span>: <span style=color:#f99b15>TCP</span>
            - <span style=color:#5bc4bf>containerPort</span>: <span style=color:#f99b15>9093</span>
              <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>http-metrics</span>
              <span style=color:#5bc4bf>protocol</span>: <span style=color:#f99b15>TCP</span>
</code></pre></td></tr></table></div></div><p>상기 <strong>pr12er</strong> 프로젝트에서 정의한 <strong>Deployment</strong> 스펙을 말로 풀어서 설명해보죠. <strong>Deployment</strong> 객체는 항상 <strong>1</strong>개의 <strong>Pod</strong>을 유지해야 합니다. 만약 <strong>Pod</strong>이 다운되어 <strong>0</strong>개가 된다면, 자동으로 하나를 구동시켜 <strong>1</strong>를 맞추도록 노력합니다.</p><p>이렇게 구동되는 <strong>Pod</strong> 내부에는 <strong>okteto.dev/codingpot-pr12er-server</strong> 라는 이름의 도커 이미지로부터 인스턴스가 만들어진 컨테이너가 구동됩니다. 만약 해당 이미지가 없다면(<strong>IfNotPresent</strong>) 이미지를 내려받으려는 시도를 하며, 이미지가 이미 있다면 있는 녀석을 사용합니다.</p><p>이 컨테이너는 <strong>grpc</strong>와 <strong>http-metrics</strong> 라는 이름의 두 포트를 노출시킵니다. 두 개 모두 <strong>TCP</strong> 프로토콜을 사용하며, 각각에 대해 노출되는 포트 번호는 <strong>9000</strong>, <strong>9093</strong> 입니다.</p><h3 id=deployment-template-spec-2>Deployment Template Spec (2)</h3><p><strong>Pod</strong>에 탑재되는 컨테이너는 여러개가 될 수 있으며, 각 컨테이너마다 사용 가능한 자원 정보를 명시해 줄 수 있습니다. 이는 <strong>Pod</strong>이 배포될 환경에 따라 매우 상이하게 설정될 수 있는 정보입니다. 일반적으로 배포될 환경의 공식문서를 참조하거나, <code>kubectl top node</code> 와 같은 명령어로 가용 리소스를 체크하여 기입합니다.</p><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#5bc4bf>spec</span>:
  <span style=color:#5bc4bf>replicas</span>: <span style=color:#f99b15>1</span>
  <span style=color:#5bc4bf>selector</span>:
    <span style=color:#776e71># ommited</span>
  <span style=color:#5bc4bf>template</span>:
    <span style=color:#776e71># ommited</span>
    <span style=color:#5bc4bf>spec</span>:
      <span style=color:#5bc4bf>containers</span>:
        - <span style=color:#5bc4bf>image</span>: <span style=color:#f99b15>okteto.dev/codingpot-pr12er-server</span>
            <span style=color:#776e71># ommited</span>
          <span style=color:#5bc4bf>ports</span>:
            <span style=color:#776e71># ommited</span>
          <span style=color:#5bc4bf>resources</span>:
            <span style=color:#5bc4bf>requests</span>:
              <span style=color:#5bc4bf>cpu</span>: <span style=color:#f99b15>10m</span>
              <span style=color:#5bc4bf>memory</span>: <span style=color:#f99b15>10m</span>
            <span style=color:#5bc4bf>limits</span>:
              <span style=color:#5bc4bf>cpu</span>: <span style=color:#f99b15>1000m</span>
              <span style=color:#5bc4bf>memory</span>: <span style=color:#f99b15>2Gi         </span>
          <span style=color:#5bc4bf>env</span>:
            - <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>PR12ER_GRPC_PORT</span>
              <span style=color:#5bc4bf>value</span>: <span style=color:#48b685>&#34;9000&#34;</span>
            - <span style=color:#5bc4bf>name</span>: <span style=color:#f99b15>PR12ER_PROMETHEUS_PORT</span>
              <span style=color:#5bc4bf>value</span>: <span style=color:#48b685>&#34;9093&#34;</span> 
</code></pre></td></tr></table></div></div><p><strong>resources.requests</strong>에는 요청될 최소 자원 스펙을, <strong>resources.limits</strong>에는 반드시 넘지 말아야 할 자원의 상한선이 명시됩니다. 또한 <strong>cpu</strong> 필드의 <strong>10m</strong>는 열 개의 밀리코어/밀리CPU 라고 읽히며, 쿠버네티스에서는 하나의 CPU를 1000m 으로 규정하고 있습니다. 따라서 CPU 사용량을 정하는 방식으로 <strong>10m</strong> 이라고 명시하면 1/100 만큼의 컴퓨팅 파워만을 사용한다는 뜻이며, <strong>1000m</strong> 이라고 명시하면 하나의 CPU를 완전히 사용하겠다는 의미입니다.</p><p>추가적으로 <strong>containers.env</strong> 필드는 컨테이너 내부에서 사용될 환경변수를 설정하는 데 쓰입니다. 컨테이너에서 특정 애플리케이션 구동시 필요한 환경변수가 있다면, 여기를 통해서 정의할 수 있습니다.</p><h3 id=deployment-template-spec-3>Deployment Template Spec (3)</h3><p>이제 마지막으로 <strong>containers.readinessProbe</strong>와 <strong>containers.livenessProbe</strong> 필드를 살펴볼 차례입니다. 두 필드는 모두 컨테이너의 건강 상태를 체크하고, 그 상태에 따른 조치를 취하는 작업을 정의하는 데 쓰입니다.</p><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#5bc4bf>spec</span>:
  <span style=color:#5bc4bf>replicas</span>: <span style=color:#f99b15>1</span>
  <span style=color:#5bc4bf>selector</span>:
    <span style=color:#776e71># ommited</span>
  <span style=color:#5bc4bf>template</span>:
    <span style=color:#776e71># ommited</span>
    <span style=color:#5bc4bf>spec</span>:
      <span style=color:#5bc4bf>containers</span>:
        - <span style=color:#5bc4bf>image</span>: <span style=color:#f99b15>okteto.dev/codingpot-pr12er-server</span>
            <span style=color:#776e71># ommited</span>
          <span style=color:#5bc4bf>ports</span>:
            <span style=color:#776e71># ommited</span>
          <span style=color:#5bc4bf>resources</span>:
            <span style=color:#776e71># ommited       </span>
          <span style=color:#5bc4bf>env</span>:
            <span style=color:#776e71># ommited</span>

          <span style=color:#5bc4bf>readinessProbe</span>:
            <span style=color:#5bc4bf>exec</span>:
              <span style=color:#5bc4bf>command</span>: [<span style=color:#48b685>&#34;/bin/grpc_health_probe&#34;</span>, <span style=color:#48b685>&#34;--addr=:9000&#34;</span>]
            <span style=color:#5bc4bf>initialDelaySeconds</span>: <span style=color:#f99b15>10</span>

          <span style=color:#5bc4bf>livenessProbe</span>:
            <span style=color:#5bc4bf>exec</span>:
              <span style=color:#5bc4bf>command</span>: [<span style=color:#48b685>&#34;/bin/grpc_health_probe&#34;</span>, <span style=color:#48b685>&#34;--addr=:9000&#34;</span>]
            <span style=color:#5bc4bf>initialDelaySeconds</span>: <span style=color:#f99b15>20</span>
            <span style=color:#5bc4bf>periodSeconds</span>: <span style=color:#f99b15>60</span>            
</code></pre></td></tr></table></div></div><p><strong>readinessProbe</strong>와 <strong>livenessProbe</strong> 모두 <strong>exec</strong> 라는 하위 필드가 존재하는 데, 이 필드는 조건을 의미한다. 이 조건을 만족할 때만 특정 액션을 취하겠다는 것입니다. 그러면 각각은 어떤 액션을 취할까요?</p><p><strong>readinessProbe</strong>는 정의된 조건을 만족할 때만 트래픽을 수용합니다. 여러가지 상황이 존재할 수 있으며, 일반적으로 거론되는 상황으로는 연동되는 다른 <strong>Pod</strong>이 살아날 때까지, 내부적으로 대규모 처리를 수행중이어서 그 작업이 종료될 때까지와 같은것들이 있습니다.</p><p><strong>livenessProbe</strong>는 정의된 조건을 만족할 때만 컨테이너를 유지합니다. 만약 여기서 정의된 조건이 실패하면 컨테이너는 삭제되고, 새로운 컨테이너가 구동됩니다.</p><p>두 개 모두 <strong>initialDelaySeconds</strong>라는 하위 필드에서 초기의 상태 체크에 허용하는 지연을, 상태 체크를 얼마만큼 주기적으로 수행할지를 정의하는 <strong>periodSeconds</strong> 하위 필드를 가집니다. <strong>pr12er</strong> 프로젝트에서는 두 개 모두 단순히 <strong>grpc_health_probe</strong>를 통한 상태 체크를 조건으로 걸고 있지만, 이 두개를 다르게 운용해도 무관합니다.</p><h2 id=마치며>마치며</h2><p><strong>Deployment</strong>, <strong>Service</strong>, <strong>Ingress</strong>로 엮인 큰 그림은 외부 트래픽이 쿠버네티스라는 플랫폼 내부에서 구동중인 애플리케이션을 찾아가는 과정이라고 볼 수 있습니다. 그리고 원하는 대상을 찾는 방법은 메타데이터에 명시된 레이블과 이름만을 활용하였죠.</p><p>모든 명세서를 수작업으로 만들어도 되겠지만, 일반적으로는 아래와 같은 명령어를 통해 템플릿을 만들 수 있습니다. 특히 템플릿에 지정된 이름은 각 메타데이터에 주입되어, 기본적인 식별값을 자동으로 채워넣어 실수를 줄일 수 있습니다.</p><div class=highlight><div style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#e7e9db;background-color:#2f1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#776e71># https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#create</span>
&gt; kubectl create deployment server --dry-run<span style=color:#5bc4bf>=</span>client -o yaml
&gt; kubectl create ingress server ...
&gt; kubectl create service server ...
</code></pre></td></tr></table></div></div><p>마지막으로 gRPC 애플리케이션 배포를 위해 기억해둘 것은 <strong>Ingress</strong> 객체 정의시 gRPC를 지원하는 <strong>Ingress</strong> 컨트롤러와 백엔드 프로토콜을 설정하는 것입니다. <strong>pr12er</strong> 프로젝트에서는 **kubernetes.io/ingress.class: &ldquo;nginx&rdquo;**와 **nginx.ingress.kubernetes.io/backend-protocol: &ldquo;GRPC&rdquo;**를 사용하였고, 라즈베리파이 같은 경우는 **kubernetes.io/ingress.class: &ldquo;traefik&rdquo;**과 <strong>ingress.kubernetes.io/protocol: h2c</strong> 이 사용될 수 있습니다.</p><p>쿠버네티스 환경에 gRPC를 활용한 애플리케이션을 배포하고 싶다면 이를 꼭 확인하기 바랍니다.</p></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#어떤-yaml-파일들이-존재하나>어떤 <strong>yaml</strong> 파일들이 존재하나?</a></li><li><a href=#ingress>Ingress</a><ul><li><a href=#ingress-annotations>Ingress Annotations</a></li><li><a href=#ingress-spec>Ingress Spec</a></li></ul></li><li><a href=#service>Service</a><ul><li><a href=#service-metadata>Service Metadata</a></li><li><a href=#service-spec>Service Spec</a></li></ul></li><li><a href=#deployment>Deployment</a><ul><li><a href=#deployment-metadata>Deployment Metadata</a></li><li><a href=#deployment-spec>Deployment Spec</a></li><li><a href=#deployment-template-spec-1>Deployment Template Spec (1)</a></li><li><a href=#deployment-template-spec-2>Deployment Template Spec (2)</a></li><li><a href=#deployment-template-spec-3>Deployment Template Spec (3)</a></li></ul></li><li><a href=#마치며>마치며</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&text=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&title=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&is_video=false&description=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95&body=Check out this article: https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&title=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&title=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&name=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95&description=%ec%bd%94%eb%94%a9%eb%83%84%eb%b9%84%20%ed%94%84%eb%a1%9c%ec%a0%9d%ed%8a%b8%20%ec%a4%91%20pr12er%eb%8a%94%20TensorFlow%20Korea%ec%9d%98%20%eb%85%bc%eb%ac%b8%ec%9d%84%20%ec%9d%bd%ea%b3%a0%2f%eb%a6%ac%eb%b7%b0%ed%95%98%eb%8a%94%20%eb%aa%a8%ec%9e%84%20PR12%ec%97%90%ec%84%9c%20%ec%b4%ac%ec%98%81%eb%90%9c%20%eb%8f%99%ec%98%81%ec%83%81%ec%9d%84%20%ed%81%90%eb%a0%88%ec%9d%b4%ec%85%98%ed%95%98%eb%8a%94%20%ed%94%84%eb%a1%9c%ec%a0%9d%ed%8a%b8%ec%9e%85%eb%8b%88%eb%8b%a4.%20%ea%b0%9c%eb%9e%b5%ec%a0%81%ec%9c%bc%eb%a1%9c%20%ed%94%84%eb%a1%a0%ed%8a%b8%ec%97%94%eb%93%9c%eb%8a%94%20Flutter%2c%20%eb%b0%b1%ec%97%94%eb%93%9c%eb%8a%94%20GO%eb%a1%9c%20%ec%9e%91%ec%84%b1%eb%90%98%ec%97%88%ec%9c%bc%eb%a9%b0%2c%20%ec%9d%b4%20%eb%91%98%ea%b0%84%ec%9d%98%20%ec%9d%b8%ed%84%b0%ed%8e%98%ec%9d%b4%ec%8a%a4%eb%8a%94%20gRPC%2fprotobuf%eb%a1%9c%20%ea%b5%ac%ec%84%b1%eb%90%98%ec%96%b4%ec%9e%88%ec%8a%b5%eb%8b%88%eb%8b%a4.%20%ed%8a%b9%ed%9e%88%20pr12er%20%ed%94%84%eb%a1%9c%ec%a0%9d%ed%8a%b8%ec%9d%98%20%eb%b0%b1%ec%97%94%eb%93%9c%20%ec%84%9c%eb%b2%84%eb%8a%94%20PR%ec%9d%b4%20Merge%20%eb%90%a8%ea%b3%bc%20%eb%8f%99%ec%8b%9c%ec%97%90%20Okteto%ea%b0%80%20%ec%a0%9c%ea%b3%b5%ed%95%98%eb%8a%94k8s%20%ec%97%90%20%eb%b0%b0%ed%8f%ac%eb%90%98%eb%8a%94%20CD%20%eb%a3%a8%ed%8b%b4%ec%9d%84%20%ed%83%91%eb%8b%88%eb%8b%a4.%0a%20%ec%9d%b4%20%ea%b8%80%ec%9d%80%20Okteto%20%ec%97%90%20%eb%b0%b0%ed%8f%ac%ed%95%98%ea%b8%b0%ec%9c%84%ed%95%9c%20%ed%8c%8c%ec%9d%b4%ed%94%84%eb%9d%bc%ec%9d%b8%ec%9d%84%20%eb%b6%84%ec%84%9d%ed%95%98%eb%8a%94%20%ec%b4%9d%20X%20%ed%8e%b8%ec%9d%98%20%ec%8b%9c%eb%a6%ac%ec%a6%88%eb%ac%bc%20%ec%a4%91%20%eb%91%90%20%eb%b2%88%ec%a7%b8%ec%9e%85%eb%8b%88%eb%8b%a4.%0a%20Okteto%20%ed%8c%8c%ec%9d%b4%ed%94%84%eb%9d%bc%ec%9d%b8%20%ea%b0%9c%ec%9a%94%2c%20okteto%20build%2c%20pr12er%20%ec%84%9c%eb%b2%84%ec%9a%a9%20Dockerfile%20%eb%b6%84%ec%84%9d%20Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95%20%26hellip%3b%26hellip%3b%26hellip%3b%26hellip%3b%26hellip%3b." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fcodingpot.github.io%2fposts%2f2021-06-12-okteto-kubectl-apply%2f&t=Okteto%ec%97%90%20gRPC%ec%9a%a9%20Deployment%2c%20Service%2c%20Ingress%20%ec%84%a4%ec%a0%95" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick="$('#nav-footer').toggle();return false;" aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc-toggle class=icon href=# onclick="$('#toc-footer').toggle();return false;" aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share-toggle class=icon href=# onclick="$('#share-footer').toggle();return false;" aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2021 코딩냄비</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>